name: Swift Syntax Check

on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]
  workflow_dispatch:

jobs:
  syntax-check:
    runs-on: macos-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v3
      
    - name: Setup Xcode
      uses: maxim-lobanov/setup-xcode@v1
      with:
        xcode-version: latest-stable
        
    - name: Organize Files
      run: |
        mkdir -p CareerFairLoginApp
        mv CareerFairLoginAppApp.swift CareerFairLoginApp/ 2>/dev/null || true
        mv Models CareerFairLoginApp/ 2>/dev/null || true
        mv Views CareerFairLoginApp/ 2>/dev/null || true
        
    - name: Check Swift Syntax
      run: |
        SDK_PATH=$(xcrun --show-sdk-path --sdk iphonesimulator)
        echo "Checking Swift files with SDK: $SDK_PATH"
        
        cd CareerFairLoginApp
        
        # Check each Swift file
        for file in *.swift Views/*.swift Models/*.swift; do
          if [ -f "$file" ]; then
            echo "Checking: $file"
            swiftc -typecheck "$file" \
              -sdk "$SDK_PATH" \
              -target arm64-apple-ios16.0-simulator \
              -import-objc-header 2>&1 || {
              echo "Error in $file"
              exit 1
            }
          fi
        done
        
        echo "âœ… All Swift files compile successfully!"

